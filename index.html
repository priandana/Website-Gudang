<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Portal Spreadsheet ‚Ä¢ Praktis</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #020617;
      --bg-soft: #0b1120;
      --primary: #f97316;
      --accent: #38bdf8;
      --border: rgba(148,163,184,0.4);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --ok: #22c55e;
      --warn: #f59e0b;
      --bad: #ef4444;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
    body {
      min-height: 100vh;
      background: radial-gradient(circle at top left, #1d4ed8, #020617 45%, #0b1120 100%);
      color: var(--text-main);
      padding: 18px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .blob { position: fixed; border-radius: 999px; filter: blur(70px); mix-blend-mode: screen; opacity: 0.6; pointer-events: none; z-index: 0; animation: float 22s ease-in-out infinite alternate; }
    .blob-1 { width: 340px; height: 340px; background:#fb923c; top:-80px; left:-80px; }
    .blob-2 { width: 360px; height: 360px; background:#22d3ee; bottom:-100px; right:-40px; animation-delay:4s; }
    .blob-3 { width: 260px; height: 260px; background:#4f46e5; bottom:10%; left:12%; animation-delay:8s; }
    @keyframes float { 0% { transform: translate3d(0,0,0) scale(1); } 100% { transform: translate3d(26px,-30px,0) scale(1.06); } }

    .shell {
      position: relative; z-index: 1;
      max-width: 1200px; width: 100%;
      background: radial-gradient(circle at top left, rgba(15,23,42,0.98), rgba(15,23,42,0.92));
      border-radius: 26px; border: 1px solid var(--border);
      box-shadow: 0 24px 60px rgba(15,23,42,0.95);
      padding: 18px;
      max-height: calc(100vh - 40px);
      display:flex; flex-direction:column;
    }

    .top { display:flex; justify-content:space-between; align-items:center; gap:10px; margin-bottom:10px; }
    .brand { display:flex; align-items:center; gap:10px; }
    .logo-circle { width:34px; height:34px; border-radius:14px; background: conic-gradient(from 160deg,#f97316,#1d4ed8,#38bdf8,#f97316); display:flex; align-items:center; justify-content:center; box-shadow:0 10px 26px rgba(15,23,42,0.9); }
    .logo-inner { width:25px; height:25px; border-radius:10px; background:#020617; display:flex; align-items:center; justify-content:center; font-size:0.7rem; font-weight:700; letter-spacing:0.06em; color:var(--primary); }
    .brand-text { display:flex; flex-direction:column; gap:1px; }
    .brand-name { font-size:0.94rem; font-weight:600; }
    .brand-sub { font-size:0.72rem; color:var(--text-muted); }
    .top-info { font-size:0.74rem; color:var(--text-muted); text-align:right; line-height:1.3; }

    .hero { margin-bottom:10px; }
    .hero-title { font-size:1.6rem; font-weight:600; margin-bottom:4px; }
    .gradient-text { background: linear-gradient(135deg,#f97316,#fb923c,#38bdf8); -webkit-background-clip:text; color:transparent; }
    .hero-sub { font-size:0.86rem; color:var(--text-muted); max-width:520px; }

    .pill-row { display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; margin-bottom:8px; font-size:0.72rem; }
    .pill { padding:4px 9px; border-radius:999px; border:1px solid rgba(148,163,184,0.5); background:rgba(15,23,42,0.96); color:var(--text-muted); }

    /* Banner pengumuman */
    .banner {
      margin-top:10px;
      border-radius:16px;
      border:1px solid rgba(148,163,184,0.35);
      background: linear-gradient(135deg, rgba(249,115,22,0.18), rgba(56,189,248,0.14));
      padding:10px 10px;
      display:flex;
      align-items:flex-start;
      gap:10px;
    }
    .banner.hide { display:none; }
    .banner .b-ico{
      width:28px;height:28px;border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      background:rgba(15,23,42,0.85);
      border:1px solid rgba(148,163,184,0.25);
      flex:0 0 auto;
    }
    .banner .b-text{ display:flex; flex-direction:column; gap:2px; min-width:0; }
    .banner .b-title{ font-weight:700; font-size:0.84rem; }
    .banner .b-desc{ font-size:0.76rem; color:rgba(229,231,235,0.85); line-height:1.35; }
    .banner .b-actions{ margin-left:auto; display:flex; gap:8px; flex:0 0 auto; }
    .banner .b-btn{
      height:30px; padding:0 10px; border-radius:999px;
      border:1px solid rgba(148,163,184,0.35);
      background:rgba(15,23,42,0.9);
      color:var(--text-main);
      font-size:0.74rem;
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease;
      white-space:nowrap;
    }
    .banner .b-btn:hover{ transform: translateY(-1px); border-color: rgba(56,189,248,0.7); }

    /* CONTENT */
    .content{
      margin-top:8px;
      border-radius:18px;
      border:1px solid rgba(148,163,184,0.4);
      background:rgba(15,23,42,0.96);
      flex:1;
      display:flex;
      flex-direction:column;
      overflow:hidden;
      min-height:0;
    }
    .content-header{
      padding:10px;
      border-bottom:1px solid rgba(148,163,184,0.25);
      background:rgba(15,23,42,0.98);
      backdrop-filter: blur(10px);
    }
    .content-body{
      padding:10px;
      overflow:auto;
      overflow-x:hidden;
      -webkit-overflow-scrolling: touch;
      min-height:0;
    }
    .row-topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }

    /* Search */
    .search-wrap{
      display:flex; align-items:center; gap:8px;
      width:min(560px, 100%);
      margin-left:auto;
      min-width:0;
    }
    .search-input{
      flex:1; height:36px; padding:0 12px;
      border-radius:999px; border:1px solid rgba(148,163,184,0.55);
      background:rgba(2,6,23,0.35);
      color:var(--text-main);
      outline:none;
      font-size:0.78rem;
      min-width:0;
    }
    .search-input::placeholder{ color: rgba(156,163,175,0.75); }
    .search-input:focus{
      border-color: rgba(56,189,248,0.9);
      box-shadow: 0 0 0 3px rgba(56,189,248,0.18);
    }
    .btn-clear{
      height:36px; padding:0 12px;
      border-radius:999px; border:1px solid rgba(148,163,184,0.6);
      background:rgba(15,23,42,0.96);
      color:var(--text-main);
      font-size:0.78rem;
      cursor:pointer;
      transition:transform .12s ease, border-color .12s ease;
      white-space:nowrap;
    }
    .btn-clear:hover{ transform: translateY(-1px); border-color: var(--accent); }

    /* Chips */
    .chip-row{
      margin-top:10px;
      display:flex;
      gap:8px;
      flex-wrap:nowrap;
      overflow-x:auto;
      padding-bottom:2px;
      -webkit-overflow-scrolling: touch;
    }
    .chip-row::-webkit-scrollbar{ height:0; }
    .chip{
      flex:0 0 auto;
      border:1px solid rgba(148,163,184,0.45);
      background: rgba(2,6,23,0.25);
      color: var(--text-muted);
      padding:6px 10px;
      border-radius:999px;
      font-size:0.74rem;
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease, color .12s ease;
      user-select:none;
      white-space:nowrap;
    }
    .chip:hover{ transform: translateY(-1px); border-color: rgba(56,189,248,0.75); }
    .chip.active{
      color: #0b1120;
      font-weight:700;
      border-color: rgba(56,189,248,0.9);
      background: linear-gradient(135deg, rgba(249,115,22,0.95), rgba(56,189,248,0.95));
    }

    /* Sections: Favorit & Recent */
    .special-block{
      margin-top: 0;
      padding-top: 0;
      margin-bottom: 12px;
    }
    .special-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin: 0 2px 10px;
    }
    .special-title{
      font-size:0.92rem;
      font-weight:800;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .special-badge{
      font-size:0.74rem;
      color: var(--text-muted);
      border:1px solid rgba(148,163,184,0.35);
      background: rgba(15,23,42,0.7);
      padding:4px 10px;
      border-radius:999px;
      white-space:nowrap;
    }

    /* Kategori */
    .category-block{
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px dashed rgba(148,163,184,0.35);
    }
    .category-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin: 4px 2px 10px;
    }
    .category-title{
      font-size:0.92rem;
      font-weight:800;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .cat-dot{
      width:10px;height:10px;border-radius:999px;
      background: linear-gradient(135deg,var(--primary),var(--accent));
      box-shadow: 0 8px 20px rgba(56,189,248,0.18);
    }
    .category-count{
      font-size:0.74rem;
      color: var(--text-muted);
      border:1px solid rgba(148,163,184,0.35);
      background: rgba(15,23,42,0.7);
      padding:4px 10px;
      border-radius:999px;
      white-space:nowrap;
    }
    .empty-note{
      display:none;
      margin-top:8px;
      padding:10px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,0.25);
      color: var(--text-muted);
      background: rgba(2,6,23,0.25);
      font-size:0.78rem;
    }
    .empty-note.show{ display:block; }

    /* Grid */
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap:10px; }

    /* Card */
    .card-item{
      background:rgba(15,23,42,0.98);
      border-radius:14px;
      border:1px solid rgba(148,163,184,0.6);
      padding:10px 10px 9px;
      position:relative;
      display:flex;
      flex-direction:column;
      gap:6px;
      font-size:0.8rem;
      overflow:hidden;
    }

    .badge{
      position:absolute;
      top:8px;
      right:10px;
      font-size:0.7rem;
      padding:2px 7px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.8);
      background:rgba(15,23,42,0.96);
      color:var(--text-muted);
    }

    /* Status pill */
    .status-pill{
      position:absolute;
      top:8px;
      left:10px;
      font-size:0.7rem;
      padding:2px 7px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.35);
      background:rgba(2,6,23,0.35);
      color:rgba(229,231,235,0.85);
      display:flex;
      align-items:center;
      gap:6px;
    }
    .status-dot{ width:7px;height:7px;border-radius:999px;background:var(--ok); }
    .status-maintenance .status-dot{ background: var(--warn); }
    .status-maintenance .status-pill{ border-color: rgba(245,158,11,0.45); }

    /* Favorite button */
    .fav-btn{
      position:absolute;
      bottom:10px;
      right:10px;
      width:34px;
      height:34px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.45);
      background:rgba(2,6,23,0.35);
      color:rgba(229,231,235,0.9);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .fav-btn:hover{ transform: translateY(-1px); border-color: rgba(56,189,248,0.8); }
    .fav-btn.active{
      border-color: rgba(249,115,22,0.9);
      background: rgba(249,115,22,0.18);
      color: #ffdca8;
    }
    .fav-btn span{ font-size:0.95rem; line-height:1; }

    .name-row { display:flex; align-items:center; gap:7px; margin-bottom:2px; padding-right:42px; }
    .icon { width:22px; height:22px; border-radius:9px; background: conic-gradient(from 180deg,#f97316,#1d4ed8,#38bdf8,#f97316); display:flex; align-items:center; justify-content:center; font-size:0.9rem; flex:0 0 auto; }
    .name { font-size:0.92rem; font-weight:600; }
    .desc { font-size:0.76rem; color:var(--text-muted); min-height:28px; }
    .meta { display:flex; justify-content:space-between; gap:8px; font-size:0.72rem; color:var(--text-muted); flex-wrap:wrap; }
    .meta span strong { color:var(--text-main); }

    .actions { margin-top:6px; display:flex; gap:6px; padding-right:42px; }
    .btn-main{
      flex:1; border:none; border-radius:999px; padding:7px 10px;
      font-size:0.78rem; font-weight:600; cursor:pointer;
      background: radial-gradient(circle at 0 0,#facc15,#f97316);
      color:#111827; text-decoration:none;
      display:inline-flex; align-items:center; justify-content:center; gap:6px;
      box-shadow:0 10px 22px rgba(248,113,22,0.6);
      transition:transform .12s ease, box-shadow .12s ease, filter .12s ease, opacity .12s ease;
    }
    .btn-main:hover{ transform:translateY(-1px); box-shadow:0 14px 28px rgba(248,113,22,0.75); filter:brightness(1.03); }
    .btn-main:active{ transform:translateY(0); box-shadow:0 9px 18px rgba(248,113,22,0.55); filter:brightness(.98); }

    .btn-main.disabled{
      opacity:.45;
      pointer-events:none;
      filter: grayscale(.2);
      box-shadow:none;
    }

    .btn-copy{
      min-width:38px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.8);
      background:rgba(15,23,42,0.98);
      color:var(--text-main);
      font-size:0.76rem;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      transition:background .12s ease, transform .12s ease, border-color .12s ease;
    }
    .btn-copy:hover{ background:rgba(15,23,42,1); border-color:var(--accent); transform:translateY(-1px); }

    .footer{
      margin-top:8px;
      font-size:0.72rem;
      color:var(--text-muted);
      display:flex;
      justify-content:space-between;
      gap:8px;
      flex-wrap:wrap;
    }
    .footer span.highlight { color:var(--text-main); font-weight:500; }

    /* PRELOADER */
    .preloader{
      position:fixed; inset:0; z-index:9999;
      display:flex; align-items:center; justify-content:center;
      background: radial-gradient(circle at top left, #1d4ed8, #020617 45%, #0b1120 100%);
      transition: opacity .35s ease, visibility .35s ease;
    }
    .preloader.hide{ opacity:0; visibility:hidden; pointer-events:none; }
    .pre-card{
      width:min(420px, 92vw);
      border-radius:22px;
      border:1px solid rgba(148,163,184,0.35);
      background:rgba(15,23,42,0.92);
      box-shadow:0 24px 60px rgba(15,23,42,0.95);
      padding:18px 16px;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .pre-logo{
      width:48px; height:48px; border-radius:18px;
      background: conic-gradient(from 160deg,#f97316,#1d4ed8,#38bdf8,#f97316);
      display:flex; align-items:center; justify-content:center;
      box-shadow:0 12px 28px rgba(15,23,42,0.9);
      flex:0 0 auto;
    }
    .pre-logo-inner{
      width:36px; height:36px; border-radius:14px;
      background:#020617;
      display:flex; align-items:center; justify-content:center;
      font-weight:800; letter-spacing:.06em;
      color:var(--primary); font-size:0.85rem;
    }
    .pre-text{ display:flex; flex-direction:column; gap:2px; min-width:0; }
    .pre-title{ font-weight:700; font-size:0.95rem; }
    .pre-sub{ color:var(--text-muted); font-size:0.78rem; }
    .spinner{
      margin-left:auto; width:20px; height:20px; border-radius:999px;
      border:2px solid rgba(148,163,184,0.35);
      border-top-color: rgba(56,189,248,0.95);
      animation: spin .9s linear infinite;
      flex:0 0 auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* TOAST */
    .toast-wrap{
      position:fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      z-index: 99999;
      display:flex;
      flex-direction:column;
      gap:8px;
      width:min(520px, calc(100vw - 24px));
      pointer-events:none;
    }
    .toast{
      pointer-events:none;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,0.35);
      background: rgba(15,23,42,0.92);
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 40px rgba(15,23,42,0.8);
      display:flex;
      align-items:flex-start;
      gap:10px;
      opacity:0;
      transform: translateY(10px);
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{ opacity:1; transform: translateY(0); }
    .toast .t-ico{
      width:28px;height:28px;border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      background:rgba(2,6,23,0.4);
      border:1px solid rgba(148,163,184,0.25);
      flex:0 0 auto;
    }
    .toast .t-text{ display:flex; flex-direction:column; gap:2px; min-width:0; }
    .toast .t-title{ font-weight:700; font-size:0.82rem; }
    .toast .t-desc{ color:rgba(229,231,235,0.85); font-size:0.76rem; line-height:1.25; }

    @media (max-width:720px){
      body { padding:12px; }
      .shell { padding:12px 10px; border-radius:20px; }
      .hero-title { font-size:1.35rem; }
      .row-topbar{ flex-direction:column; align-items:stretch; }
      .search-wrap{ width:100%; margin-left:0; }
      .top { flex-direction:column; align-items:flex-start; }
      .top-info{ text-align:left; }
      .banner { flex-direction:column; }
      .banner .b-actions{ margin-left:0; width:100%; }
      .banner .b-btn{ width:100%; }
    }
  </style>
</head>

<body>
  <!-- PRELOADER -->
  <div class="preloader" id="preloader" aria-label="Loading">
    <div class="pre-card">
      <div class="pre-logo"><div class="pre-logo-inner">PR</div></div>
      <div class="pre-text">
        <div class="pre-title">Praktis</div>
        <div class="pre-sub">Menyiapkan portal spreadsheet‚Ä¶</div>
      </div>
      <div class="spinner"></div>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast-wrap" id="toastWrap" aria-live="polite" aria-atomic="true"></div>

  <div class="blob blob-1"></div>
  <div class="blob blob-2"></div>
  <div class="blob blob-3"></div>

  <div class="shell">
    <div class="top">
      <div class="brand">
        <div class="logo-circle"><div class="logo-inner">PR</div></div>
        <div class="brand-text">
          <div class="brand-name">Portal Spreadsheet Praktis</div>
          <div class="brand-sub">Satu halaman untuk semua link penting</div>
        </div>
      </div>
      <div class="top-info">
        Total link: <strong id="totalLinks">0</strong><br/>
        Akses tetap mengikuti izin Google / Metabase
      </div>
    </div>

    <section class="hero">
      <div class="hero-title">
        Pilih <span class="gradient-text">spreadsheet / dashboard</span><br/>yang ingin kamu buka.
      </div>
      <p class="hero-sub">
        Semua link di bawah bisa kamu klik langsung. Untuk tim, cukup kirim URL portal ini ‚Äî lalu mereka tinggal pilih sendiri link yang dibutuhkan.
      </p>
      <div class="pill-row">
        <div class="pill">Bisa diakses dari HP & komputer</div>
        <div class="pill">Desain ringan & modern</div>
        <div class="pill">Link bisa dicopy cepat (tombol üîó)</div>
      </div>

      <!-- BANNER PENGUMUMAN (edit teksnya di sini) -->
      
    </section>

    <section class="content">
      <header class="content-header">
        <div class="row-topbar">
          <span id="resultInfo">Daftar link (0)</span>

          <div class="search-wrap">
            <input id="searchInput" class="search-input" type="search"
                   placeholder="Cari: nama, tipe, badge‚Ä¶ (contoh: metabase / inbound / qc)"
                   autocomplete="off" />
            <button id="clearSearch" class="btn-clear" type="button">Reset</button>
          </div>
        </div>

        <div class="chip-row" id="chipRow" aria-label="Filter kategori">
          <button class="chip active" type="button" data-filter="All">Semua</button>
          <button class="chip" type="button" data-filter="Fav">‚≠ê Favorit</button>
          <button class="chip" type="button" data-filter="Recent">üïò Recent</button>
          <button class="chip" type="button" data-filter="Umum">Umum</button>
          <button class="chip" type="button" data-filter="Finishgood">Finishgood</button>
          <button class="chip" type="button" data-filter="Material">Material</button>
        </div>
      </header>

      <div class="content-body">
        <!-- FAVORIT -->
        <section class="special-block" id="favBlock">
          <div class="special-head">
            <div class="special-title">‚≠ê Favorit</div>
            <div class="special-badge" id="favCount">0</div>
          </div>
          <div class="grid" id="gridFav"></div>
          <div class="empty-note" id="emptyFav">Belum ada favorit. Klik tombol ‚≠ê di card untuk menambahkan.</div>
        </section>

        <!-- RECENT -->
        <section class="special-block" id="recentBlock">
          <div class="special-head">
            <div class="special-title">üïò Terakhir dibuka</div>
            <div class="special-badge" id="recentCount">0</div>
          </div>
          <div class="grid" id="gridRecent"></div>
          <div class="empty-note" id="emptyRecent">Belum ada riwayat. Saat kamu klik ‚ÄúBuka‚Äù, link akan muncul di sini.</div>
        </section>

        <!-- KATEGORI: UMUM -->
        <section class="category-block" id="catUmum">
          <div class="category-head">
            <div class="category-title"><span class="cat-dot"></span> Umum</div>
            <div class="category-count" id="countUmum">0 link</div>
          </div>
          <div class="grid" id="gridUmum"></div>
          <div class="empty-note" id="emptyUmum">Tidak ada link yang cocok di kategori Umum.</div>
        </section>

        <!-- KATEGORI: FINISHGOOD -->
        <section class="category-block" id="catFinishgood">
          <div class="category-head">
            <div class="category-title"><span class="cat-dot"></span> Finishgood</div>
            <div class="category-count" id="countFinishgood">0 link</div>
          </div>
          <div class="grid" id="gridFinishgood"></div>
          <div class="empty-note" id="emptyFinishgood">Tidak ada link yang cocok di kategori Finishgood.</div>
        </section>

        <!-- KATEGORI: MATERIAL -->
        <section class="category-block" id="catMaterial">
          <div class="category-head">
            <div class="category-title"><span class="cat-dot"></span> Material</div>
            <div class="category-count" id="countMaterial">0 link</div>
          </div>
          <div class="grid" id="gridMaterial"></div>
          <div class="empty-note" id="emptyMaterial">Tidak ada link yang cocok di kategori Material.</div>
        </section>

        <!-- HIDDEN: Taruh semua card di sini (JS akan memindahkan) -->
        <div id="allCards" style="display:none;">
          <!-- ====== CONTOH LINK (TINGGAL TAMBAH) ====== -->

          <!-- data-status: active / maintenance -->
          <article class="card-item" data-category="Umum" data-status="active">
            <div class="badge">5R</div>
            <div class="name-row">
              <div class="icon">üìä</div>
              <div class="name">Spreadsheet 01</div>
            </div>
            <p class="desc">5R adalah metode penataan tempat kerja dari Jepang (5S) yang diterjemahkan menjadi Ringkas, Rapi, Resik, Rawat, Rajin.</p>
            <div class="meta">
              <span>Tipe: <strong>5R</strong></span>
              <span>No: <strong>1</strong></span>
            </div>
            <div class="actions">
              <a class="btn-main" href="https://docs.google.com/spreadsheets/d/1XdpWzeDne-g8TZZLqNzlXk2Wbq6hNgUACI6U7BcTqzg/edit?gid=607962061#gid=607962061" target="_blank" rel="noopener noreferrer">Buka</a>
              <button class="btn-copy" data-link="https://docs.google.com/spreadsheets/d/1XdpWzeDne-g8TZZLqNzlXk2Wbq6hNgUACI6U7BcTqzg/edit?gid=607962061#gid=607962061" title="Copy link">üîó</button>
            </div>
          </article>

          <article class="card-item" data-category="Finishgood" data-status="active">
            <div class="badge">Output QC</div>
            <div class="name-row">
              <div class="icon">üìà</div>
              <div class="name">Data Output QC</div>
            </div>
            <p class="desc">Spreadsheet untuk melihat jumlah output yang dilakukan oleh tim QC.</p>
            <div class="meta">
              <span>Tipe: <strong>Output QC</strong></span>
              <span>No: <strong>2</strong></span>
            </div>
            <div class="actions">
              <a class="btn-main" href="https://docs.google.com/spreadsheets/d/1fgt5pTaPN86wHWd2vMmk5LUw3RWTq3n8fqPSWkkcGaM/edit?hl=id&gid=1631834911#gid=1631834911" target="_blank" rel="noopener noreferrer">Buka</a>
              <button class="btn-copy" data-link="https://docs.google.com/spreadsheets/d/1fgt5pTaPN86wHWd2vMmk5LUw3RWTq3n8fqPSWkkcGaM/edit?hl=id&gid=1631834911#gid=1631834911" title="Copy link">üîó</button>
            </div>
          </article>

          <!-- contoh maintenance: tombol buka akan disable -->
          <article class="card-item" data-category="Material" data-status="maintenance">
            <div class="badge">Inbound</div>
            <div class="name-row">
              <div class="icon">üì¶</div>
              <div class="name">Dashboard Material (Maintenance)</div>
            </div>
            <p class="desc">Sedang maintenance. Hubungi PIC jika harus akses segera.</p>
            <div class="meta">
              <span>Tipe: <strong>Material</strong></span>
              <span>No: <strong>3</strong></span>
            </div>
            <div class="actions">
              <a class="btn-main" href="https://example.com" target="_blank" rel="noopener noreferrer">Buka</a>
              <button class="btn-copy" data-link="https://example.com" title="Copy link">üîó</button>
            </div>
          </article>
        </div>
      </div>
    </section>

    <footer class="footer">
      <span>Catatan: perubahan data tetap dilakukan di Google Sheets / Metabase, bukan di portal ini.</span>
      <span class="highlight">Portal Spreadsheet ‚Ä¢ Praktis</span>
    </footer>
  </div>

  <script>
    // ===== SETTINGS (localStorage keys) =====
    const LS_FAVS = "praktis_favs_v1";
    const LS_RECENT = "praktis_recent_v1";
    const LS_BANNER_HIDE = "praktis_banner_hide_v1";
    const RECENT_LIMIT = 8;

    // ===== PRELOADER =====
    window.addEventListener("load", () => {
      const pre = document.getElementById("preloader");
      if (pre) setTimeout(() => pre.classList.add("hide"), 250);
    });

    // ===== TOAST =====
    const toastWrap = document.getElementById("toastWrap");
    function showToast(title, desc, icon="‚úÖ") {
      if (!toastWrap) return;
      const el = document.createElement("div");
      el.className = "toast";
      el.innerHTML = `
        <div class="t-ico">${icon}</div>
        <div class="t-text">
          <div class="t-title">${escapeHtml(title)}</div>
          <div class="t-desc">${escapeHtml(desc || "")}</div>
        </div>
      `;
      toastWrap.appendChild(el);
      requestAnimationFrame(() => el.classList.add("show"));
      setTimeout(() => {
        el.classList.remove("show");
        setTimeout(() => el.remove(), 220);
      }, 1800);
    }
    function escapeHtml(str){
      return String(str ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // ===== BANNER =====
    const banner = document.getElementById("banner");
    const bannerClose = document.getElementById("bannerClose");
    if (banner && localStorage.getItem(LS_BANNER_HIDE) === "1") banner.classList.add("hide");
    if (bannerClose) {
      bannerClose.addEventListener("click", () => {
        banner?.classList.add("hide");
        localStorage.setItem(LS_BANNER_HIDE, "1");
        showToast("Pengumuman disembunyikan", "Kamu bisa tampilkan lagi dengan hapus cache/localStorage.", "üì¢");
      });
    }

    // ===== HELPERS =====
    function loadFavs() {
      try { return new Set(JSON.parse(localStorage.getItem(LS_FAVS) || "[]")); }
      catch { return new Set(); }
    }
    function saveFavs(set) {
      localStorage.setItem(LS_FAVS, JSON.stringify(Array.from(set)));
    }
    function loadRecent() {
      try { return JSON.parse(localStorage.getItem(LS_RECENT) || "[]"); }
      catch { return []; }
    }
    function saveRecent(arr) {
      localStorage.setItem(LS_RECENT, JSON.stringify(arr.slice(0, RECENT_LIMIT)));
    }
    function getHref(card){
      return card.querySelector(".btn-main")?.getAttribute("href") || "";
    }
    function getStatus(card){
      return (card.getAttribute("data-status") || "active").toLowerCase().trim();
    }

    // ===== COPY BUTTON + OPEN TRACKING =====
    function bindCopyButtons(scope=document) {
      scope.querySelectorAll(".btn-copy").forEach(btn => {
        if (btn.__bound) return;
        btn.__bound = true;
        btn.addEventListener("click", () => {
          const link = btn.getAttribute("data-link");
          if (!link) return;
          navigator.clipboard.writeText(link).then(() => {
            showToast("Link dicopy", "Berhasil disalin ke clipboard.", "üîó");
          });
        });
      });
    }

    // track recent when open clicked (active only)
    function bindOpenTracking(scope=document) {
      scope.querySelectorAll(".btn-main").forEach(a => {
        if (a.__boundOpen) return;
        a.__boundOpen = true;
        a.addEventListener("click", (e) => {
          const card = a.closest(".card-item");
          if (!card) return;

          const status = getStatus(card);
          if (status === "maintenance") {
            e.preventDefault();
            showToast("Sedang maintenance", "Link ini sementara dinonaktifkan.", "üõ†Ô∏è");
            return;
          }

          const href = a.getAttribute("href");
          if (!href) return;

          const recent = loadRecent();
          const now = Date.now();
          const cleaned = recent.filter(x => x && x.href !== href);
          cleaned.unshift({ href, ts: now });
          saveRecent(cleaned);

          refreshSpecialBlocks(); // update Recent section
        });
      });
    }

    // ===== FAVORITE BUTTON =====
    function ensureFavAndStatusUI(card, favs) {
      // status pill
      if (!card.querySelector(".status-pill")) {
        const status = getStatus(card);
        const pill = document.createElement("div");
        pill.className = "status-pill";
        pill.innerHTML = `<span class="status-dot"></span><span class="status-text">${status === "maintenance" ? "Maintenance" : "Aktif"}</span>`;
        card.appendChild(pill);

        if (status === "maintenance") {
          card.classList.add("status-maintenance");
          const openBtn = card.querySelector(".btn-main");
          if (openBtn) openBtn.classList.add("disabled");
        }
      }

      // fav btn
      if (!card.querySelector(".fav-btn")) {
        const btn = document.createElement("button");
        btn.className = "fav-btn";
        btn.type = "button";
        btn.innerHTML = `<span>‚òÜ</span>`;
        card.appendChild(btn);

        btn.addEventListener("click", () => {
          const href = getHref(card);
          if (!href) return;

          const set = loadFavs();
          const isFav = set.has(href);
          if (isFav) {
            set.delete(href);
            showToast("Favorit dihapus", "Link dikeluarkan dari Favorit.", "‚≠ê");
          } else {
            set.add(href);
            showToast("Favorit ditambahkan", "Link masuk ke Favorit.", "‚≠ê");
          }
          saveFavs(set);
          syncFavButtons();      // update all buttons state
          refreshSpecialBlocks(); // update Favorite section
          applyFilter();          // if chip on Fav/Recent
        });
      }

      // initial state
      const href = getHref(card);
      const btn = card.querySelector(".fav-btn");
      if (btn) {
        const isFav = href && favs.has(href);
        btn.classList.toggle("active", isFav);
        btn.querySelector("span").textContent = isFav ? "‚òÖ" : "‚òÜ";
        btn.title = isFav ? "Hapus dari Favorit" : "Tambahkan ke Favorit";
      }
    }

    function syncFavButtons() {
      const favs = loadFavs();
      document.querySelectorAll(".card-item").forEach(card => ensureFavAndStatusUI(card, favs));
    }

    // ===== CATEGORY GRIDS =====
    const allCardsWrap = document.getElementById("allCards");
    const cards = Array.from(allCardsWrap?.querySelectorAll(".card-item") || []);

    const grids = {
      Umum: document.getElementById("gridUmum"),
      Finishgood: document.getElementById("gridFinishgood"),
      Material: document.getElementById("gridMaterial"),
    };

    const counts = {
      Umum: document.getElementById("countUmum"),
      Finishgood: document.getElementById("countFinishgood"),
      Material: document.getElementById("countMaterial"),
    };

    const empties = {
      Umum: document.getElementById("emptyUmum"),
      Finishgood: document.getElementById("emptyFinishgood"),
      Material: document.getElementById("emptyMaterial"),
    };

    // special blocks
    const gridFav = document.getElementById("gridFav");
    const gridRecent = document.getElementById("gridRecent");
    const emptyFav = document.getElementById("emptyFav");
    const emptyRecent = document.getElementById("emptyRecent");
    const favCount = document.getElementById("favCount");
    const recentCount = document.getElementById("recentCount");

    function normalizeCategory(val){
      const v = (val || "").toLowerCase().trim();
      if (v === "finishgood") return "Finishgood";
      if (v === "material") return "Material";
      return "Umum";
    }

    // move cards to category grids
    cards.forEach(card => {
      const cat = normalizeCategory(card.getAttribute("data-category"));
      card.setAttribute("data-category", cat);
      (grids[cat] || grids.Umum).appendChild(card);
    });

    // total link
    const totalLinksEl = document.getElementById("totalLinks");
    if (totalLinksEl) totalLinksEl.textContent = String(cards.length);

    // add status + fav buttons and bindings
    syncFavButtons();
    bindCopyButtons(document);
    bindOpenTracking(document);

    // ===== SPECIAL BLOCKS RENDER (clone cards) =====
    function cloneCardForSpecial(original) {
      const clone = original.cloneNode(true);

      // remove any old listeners markers
      clone.querySelectorAll("*").forEach(n => { n.__bound = false; n.__boundOpen = false; });

      // disable fav within clone? No, allow toggle (sync by href)
      const href = clone.querySelector(".btn-main")?.getAttribute("href") || "";

      // fix button in clone
      const favBtn = clone.querySelector(".fav-btn");
      if (favBtn) {
        favBtn.addEventListener("click", (e) => {
          e.preventDefault();
          const set = loadFavs();
          if (!href) return;
          const isFav = set.has(href);
          if (isFav) {
            set.delete(href);
            showToast("Favorit dihapus", "Link dikeluarkan dari Favorit.", "‚≠ê");
          } else {
            set.add(href);
            showToast("Favorit ditambahkan", "Link masuk ke Favorit.", "‚≠ê");
          }
          saveFavs(set);
          syncFavButtons();
          refreshSpecialBlocks();
          applyFilter();
        });
      }

      // open tracking in clone
      const openBtn = clone.querySelector(".btn-main");
      if (openBtn) {
        openBtn.addEventListener("click", (e) => {
          const status = (clone.getAttribute("data-status") || "active").toLowerCase();
          if (status === "maintenance") {
            e.preventDefault();
            showToast("Sedang maintenance", "Link ini sementara dinonaktifkan.", "üõ†Ô∏è");
            return;
          }
          const recent = loadRecent();
          const now = Date.now();
          const cleaned = recent.filter(x => x && x.href !== href);
          cleaned.unshift({ href, ts: now });
          saveRecent(cleaned);
          refreshSpecialBlocks();
        });
      }

      // copy in clone
      const copyBtn = clone.querySelector(".btn-copy");
      if (copyBtn) {
        copyBtn.addEventListener("click", (e) => {
          e.preventDefault();
          const link = copyBtn.getAttribute("data-link");
          if (!link) return;
          navigator.clipboard.writeText(link).then(() => {
            showToast("Link dicopy", "Berhasil disalin ke clipboard.", "üîó");
          });
        });
      }

      return clone;
    }

    function refreshSpecialBlocks() {
      if (!gridFav || !gridRecent) return;

      gridFav.innerHTML = "";
      gridRecent.innerHTML = "";

      const favs = loadFavs();
      const recent = loadRecent();

      // Fav cards
      const favCards = cards.filter(c => favs.has(getHref(c)));
      favCards.forEach(c => gridFav.appendChild(cloneCardForSpecial(c)));
      if (favCount) favCount.textContent = String(favCards.length);
      if (emptyFav) emptyFav.classList.toggle("show", favCards.length === 0);

      // Recent cards (by href)
      const recentMap = new Map(recent.map(r => [r.href, r.ts]));
      const recentOrdered = Array.from(recentMap.keys())
        .map(href => cards.find(c => getHref(c) === href))
        .filter(Boolean);

      recentOrdered.forEach(c => gridRecent.appendChild(cloneCardForSpecial(c)));
      if (recentCount) recentCount.textContent = String(recentOrdered.length);
      if (emptyRecent) emptyRecent.classList.toggle("show", recentOrdered.length === 0);
    }

    refreshSpecialBlocks();

    // ===== SEARCH + CHIP FILTER =====
    const searchInput = document.getElementById("searchInput");
    const clearBtn = document.getElementById("clearSearch");
    const resultInfo = document.getElementById("resultInfo");
    const chipRow = document.getElementById("chipRow");
    let activeChip = "All";

    function getCardText(card){
      const name = card.querySelector(".name")?.textContent || "";
      const desc = card.querySelector(".desc")?.textContent || "";
      const badge = card.querySelector(".badge")?.textContent || "";
      const meta = card.querySelector(".meta")?.textContent || "";
      const url = card.querySelector(".btn-main")?.getAttribute("href") || "";
      const cat = card.getAttribute("data-category") || "";
      const status = card.getAttribute("data-status") || "";
      return (name + " " + desc + " " + badge + " " + meta + " " + url + " " + cat + " " + status).toLowerCase();
    }

    const cardIndex = cards.map(c => ({ el: c, text: getCardText(c) }));

    function updateCounts(){
      ["Umum","Finishgood","Material"].forEach(cat => {
        const grid = grids[cat];
        const total = grid.querySelectorAll(".card-item").length;
        const visible = Array.from(grid.querySelectorAll(".card-item")).filter(el => el.style.display !== "none").length;
        if (counts[cat]) counts[cat].textContent = `${visible}/${total} link`;
        if (empties[cat]) empties[cat].classList.toggle("show", visible === 0);
      });
    }

    function showHideBlocksForChip(){
      const favBlock = document.getElementById("favBlock");
      const recentBlock = document.getElementById("recentBlock");
      const catUmum = document.getElementById("catUmum");
      const catFinishgood = document.getElementById("catFinishgood");
      const catMaterial = document.getElementById("catMaterial");

      // default show all
      const showAll = () => {
        favBlock.style.display = "";
        recentBlock.style.display = "";
        catUmum.style.display = "";
        catFinishgood.style.display = "";
        catMaterial.style.display = "";
      };

      if (activeChip === "Fav") {
        // show only fav section
        favBlock.style.display = "";
        recentBlock.style.display = "none";
        catUmum.style.display = "none";
        catFinishgood.style.display = "none";
        catMaterial.style.display = "none";
        return;
      }
      if (activeChip === "Recent") {
        // show only recent section
        favBlock.style.display = "none";
        recentBlock.style.display = "";
        catUmum.style.display = "none";
        catFinishgood.style.display = "none";
        catMaterial.style.display = "none";
        return;
      }
      // category filters show categories only (but keep special blocks visible for convenience)
      showAll();
    }

    function applyFilter(){
      const q = (searchInput?.value || "").trim().toLowerCase();
      const favs = loadFavs();
      const recent = loadRecent().map(x => x.href);
      const recentSet = new Set(recent);

      let shown = 0;
      cardIndex.forEach(item => {
        const cat = item.el.getAttribute("data-category") || "Umum";
        const href = getHref(item.el);

        const matchSearch = !q || item.text.includes(q);

        let matchChip = true;
        if (activeChip === "All") matchChip = true;
        else if (activeChip === "Fav") matchChip = favs.has(href);
        else if (activeChip === "Recent") matchChip = recentSet.has(href);
        else matchChip = (cat === activeChip);

        const ok = matchSearch && matchChip;
        item.el.style.display = ok ? "" : "none";
        if (ok) shown++;
      });

      // update special blocks (for search text, we simply hide whole blocks when chip is Fav/Recent)
      showHideBlocksForChip();

      const total = cards.length;
      if (resultInfo) {
        const chipLabel =
          activeChip === "All" ? "Semua" :
          activeChip === "Fav" ? "Favorit" :
          activeChip === "Recent" ? "Recent" :
          activeChip;
        if (q || activeChip !== "All") {
          resultInfo.textContent = `Hasil: ${shown} dari ${total} link ‚Ä¢ Filter: ${chipLabel}${q ? ` ‚Ä¢ Kata: "${q}"` : ""}`;
        } else {
          resultInfo.textContent = `Daftar link (${total})`;
        }
      }

      updateCounts();
    }

    if (chipRow) {
      chipRow.addEventListener("click", (e) => {
        const btn = e.target.closest(".chip");
        if (!btn) return;
        chipRow.querySelectorAll(".chip").forEach(c => c.classList.remove("active"));
        btn.classList.add("active");
        activeChip = btn.getAttribute("data-filter") || "All";
        applyFilter();
      });
    }

    if (searchInput) {
      searchInput.addEventListener("input", applyFilter);
      searchInput.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          searchInput.value = "";
          applyFilter();
          searchInput.blur();
        }
        if (e.key === "/") {
          e.preventDefault();
          searchInput.focus();
        }
      });
    }

    // shortcut "/" anywhere to focus search
    document.addEventListener("keydown", (e) => {
      if (e.key === "/" && document.activeElement !== searchInput) {
        e.preventDefault();
        searchInput?.focus();
      }
    });

    if (clearBtn) {
      clearBtn.addEventListener("click", () => {
        if (searchInput) searchInput.value = "";
        activeChip = "All";
        if (chipRow) {
          chipRow.querySelectorAll(".chip").forEach(c => c.classList.remove("active"));
          chipRow.querySelector('.chip[data-filter="All"]')?.classList.add("active");
        }
        applyFilter();
        searchInput?.focus();
      });
    }

    // init
    applyFilter();
  </script>
  <!-- ANNOUNCEMENT MODAL -->
<div class="modal-backdrop" id="annBackdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="annTitle">
    <div class="modal-head">
      <div class="modal-ico">üì¢</div>
      <div class="modal-headtext">
        <div class="modal-title" id="annTitle">Pengumuman</div>
        <div class="modal-sub" id="annSub">Info penting untuk tim gudang</div>
      </div>
      <button class="modal-x" id="annClose" type="button" aria-label="Tutup">‚úï</button>
    </div>

    <div class="modal-body">
      <div class="modal-card">
        <div class="modal-card-title">Update sistem</div>
        <div class="modal-card-desc">
          Mulai <b>Senin</b>, beberapa dashboard akan berpindah. Jika ada link yang error/akses ditolak,
          segera hubungi PIC atau admin portal.
        </div>

        <ul class="modal-list">
          <li>‚úÖ Pastikan kamu login akun Google yang benar</li>
          <li>‚úÖ Kalau muncul ‚ÄúRequest access‚Äù, klik dan tunggu approval</li>
          <li>‚ö†Ô∏è Jika urgent, kirim screenshot ke PIC</li>
        </ul>

        <div class="modal-note">
          Catatan: Portal ini hanya shortcut link. Data tetap dikelola di Google Sheets / Metabase.
        </div>
      </div>
    </div>

    <div class="modal-foot">
      <label class="modal-check">
        <input type="checkbox" id="annDontShow">
        <span>Jangan tampilkan lagi</span>
      </label>

      <div class="modal-actions">
        <button class="modal-btn ghost" id="annLater" type="button">Nanti</button>
        <button class="modal-btn primary" id="annOk" type="button">Oke, Mengerti</button>
      </div>
    </div>
  </div>
</div>

</body>
</html>
